{% extends "../layout.njk" %}
{% from "govuk/components/button/macro.njk" import govukButton %}
{% from "govuk/components/back-link/macro.njk" import govukBackLink %}
{% from "govuk/components/radios/macro.njk" import govukRadios %}
{% from "govuk/components/summary-list/macro.njk" import govukSummaryList %}
{% from "govuk/components/tabs/macro.njk" import govukTabs %}
{% from "components/question/macro.njk" import renderQuestion %}
{% from "components/summary/accommodation/macro.njk" import renderSummaryFor %}

{% set accommodationSummaryHtml %}
<dl class="govuk-summary-list">
  {{ renderSummaryFor("current_accommodation", { fields: options.allFields, answers: answers, backLink: "accommodation" }) }}
  {%- if answers["type_of_no_accommodation"] != "AWAITING_ASSESSMENT" -%}
  {{ renderSummaryFor("no_accommodation_reason", { fields: options.allFields, answers: answers, backLink: backLink }) }}
  {{ renderSummaryFor("past_accommodation_details", { fields: options.allFields, answers: answers, backLink: backLink }) }}
  {{ renderSummaryFor("suitable_housing_planned", { fields: options.allFields, answers: answers, backLink: backLink }) }}
  {%- endif -%}
  {{ renderSummaryFor("accommodation_changes", { fields: options.allFields, answers: answers, backLink: backLink }) }}
</dl>
{% endset -%}

{% set practitionerAnalysisHtml %}
<dl class="govuk-summary-list">
  {{ renderSummaryListRow(
    options.allFields["accommodation_practitioner_analysis"].text,
    options.allFields["accommodation_practitioner_analysis"].value,
    "accommodation-summary-analysis-no-accommodation#practitioner-analysis"
  ) }}
  {{ renderSummaryListRow(
    options.allFields["accommodation_serious_harm"].text,
    renderSelectedOptions(options.allFields["accommodation_serious_harm"]),
    "accommodation-summary-analysis-no-accommodation#practitioner-analysis"
  ) }}
  {{ renderSummaryListRow(
    options.allFields["accommodation_risk_of_reoffending"].text,
    renderSelectedOptions(options.allFields["accommodation_risk_of_reoffending"]),
    "accommodation-summary-analysis-no-accommodation#practitioner-analysis"
  ) }}
</dl>
{% endset -%}

{% block formContent %}
{{ govukTabs({
  items: [
    {
      label: "Accommodation summary",
      id: "accommodation-summary",
      panel: {
        html: accommodationSummaryHtml
      }
    },
    {
      label: "Practitioner analysis",
      id: "practitioner-analysis",
      panel: {
        html: practitionerAnalysisHtml
      }
    }
  ]
}) }}
{% endblock %}
